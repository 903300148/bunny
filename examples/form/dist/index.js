function BunnyFormData(t){if(!(t instanceof HTMLFormElement))throw new Error("Form passed to BunnyFormData constructor is not an instance of HTMLFormElement");this._form=t,this._collection={};for(var e=this.getInputs(),n=0;n<e.length;n++){var o=e[n];this._initSingleInput(o)}}!function(){void 0===Function.prototype.name&&void 0!==Object.defineProperty&&Object.defineProperty(Function.prototype,"name",{get:function(){var t=/function\s([^(]{1,})\(/,e=t.exec(this.toString());return e&&e.length>1?e[1].trim():""},set:function(t){}})}(),function(){function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n}return"function"!=typeof window.CustomEvent&&(t.prototype=window.Event.prototype,void(window.CustomEvent=t))}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){function e(t){return"[object Array]"===Object.prototype.toString.call(t)}function n(){for(var t=0;t<F.length;t++)F[t][0](F[t][1]);F=[],v=!1}function o(t,e){F.push([t,e]),v||(v=!0,I(n,0))}function i(t,e){function n(t){c(e,t)}function o(t){s(e,t)}try{t(n,o)}catch(t){o(t)}}function r(t){var e=t.owner,n=e.state_,o=e.data_,i=t[n],r=t.then;if("function"==typeof i){n=_;try{o=i(o)}catch(t){s(r,t)}}a(r,o)||(n===_&&c(r,o),n===b&&s(r,o))}function a(t,e){var n;try{if(t===e)throw new TypeError("A promises callback cannot return that same promise.");if(e&&("function"==typeof e||"object"===("undefined"==typeof e?"undefined":_typeof(e)))){var o=e.then;if("function"==typeof o)return o.call(e,function(o){n||(n=!0,e!==o?c(t,o):l(t,o))},function(e){n||(n=!0,s(t,e))}),!0}}catch(e){return n||s(t,e),!0}return!1}function c(t,e){t!==e&&a(t,e)||l(t,e)}function l(t,e){t.state_===g&&(t.state_=y,t.data_=e,o(f,t))}function s(t,e){t.state_===g&&(t.state_=y,t.data_=e,o(h,t))}function u(t){var e=t.then_;t.then_=void 0;for(var n=0;n<e.length;n++)r(e[n])}function f(t){t.state_=_,u(t)}function h(t){t.state_=b,u(t)}function m(t){if("function"!=typeof t)throw new TypeError("Promise constructor takes a function argument");if(this instanceof m==!1)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this.then_=[],i(t,this)}var d=t.Promise,p=d&&"resolve"in d&&"reject"in d&&"all"in d&&"race"in d&&function(){var t;return new d(function(e){t=e}),"function"==typeof t}();"undefined"!=typeof exports&&exports?(exports.Promise=p?d:m,exports.Polyfill=m):"function"==typeof define&&define.amd?define(function(){return p?d:m}):p||(t.Promise=m);var v,g="pending",y="sealed",_="fulfilled",b="rejected",w=function(){},I="undefined"!=typeof setImmediate?setImmediate:setTimeout,F=[];m.prototype={constructor:m,state_:g,then_:null,data_:void 0,then:function(t,e){var n={owner:this,then:new this.constructor(w),fulfilled:t,rejected:e};return this.state_===_||this.state_===b?o(r,n):this.then_.push(n),n.then},catch:function(t){return this.then(null,t)}},m.all=function(t){var n=this;if(!e(t))throw new TypeError("You must pass an array to Promise.all().");return new n(function(e,n){function o(t){return a++,function(n){r[t]=n,--a||e(r)}}for(var i,r=[],a=0,c=0;c<t.length;c++)i=t[c],i&&"function"==typeof i.then?i.then(o(c),n):r[c]=i;a||e(r)})},m.race=function(t){var n=this;if(!e(t))throw new TypeError("You must pass an array to Promise.race().");return new n(function(e,n){for(var o,i=0;i<t.length;i++)o=t[i],o&&"function"==typeof o.then?o.then(e,n):e(o)})},m.resolve=function(t){var e=this;return t&&"object"===("undefined"==typeof t?"undefined":_typeof(t))&&t.constructor===e?t:new e(function(e){e(t)})},m.reject=function(t){var e=this;return new e(function(e,n){n(t)})}}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:void 0);var nonEnumKeys=function(t){var e=t,n=Object.getOwnPropertyNames(e),o=Object.keys(e),i=n.filter(function(t){var e=o.indexOf(t);return e==-1});return i},_typeof$1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};BunnyFormData.prototype._initSingleInput=function(t){var e=this.getInputType(t),n=e.toLowerCase();n=n.charAt(0).toUpperCase()+n.slice(1),n="_formControlParser"+n,void 0!==this[n]?this[n](t):this._formControlParserDefault(t)},BunnyFormData.prototype._formControlParserDefault=function(t){void 0!==this._collection[t.name]?(Array.isArray(this._collection[t.name])||(this._collection[t.name]=[this._collection[t.name]]),this._collection[t.name].push(t.value)):this._collection[t.name]=t.value},BunnyFormData.prototype._formControlParserRadio=function(t){t.checked&&(this._collection[t.name]=t.value)},BunnyFormData.prototype._formControlParserCheckbox=function(t){void 0===this._collection[t.name]?t.checked?this._collection[t.name]=t.value:this._collection[t.name]="":t.checked&&(Array.isArray(this._collection[t.name])||(this._collection[t.name]=[this._collection[t.name]]),this._collection[t.name].push(t.value))},BunnyFormData.prototype._formControlParserFile=function(t){this._collection[t.name]=void 0===t.files[0]||null===t.files[0]?"":t.files[0]},BunnyFormData.prototype.getInputs=function(){return Object.getOwnPropertyDescriptor(this._form.constructor.prototype,"elements").get.call(this._form)},BunnyFormData.prototype.getNamedInputs=function(){for(var t=this.getInputs(),e=Object.getOwnPropertyNames(t).filter(function(t){return isNaN(t)}),n={},o=0;o<e.length;o++){var i=e[o];n[i]=t[i]}return n},BunnyFormData.prototype.getNodeLists=function(){var t=this.getNamedInputs(),e={};for(var n in t)this.isNodeList(n)&&(e[n]=t[n]);return e},BunnyFormData.prototype.getRadioLists=function(){var t=this.getNodeLists(),e={};for(var n in t)"radio"===t[n][0].type&&(e[n]=t[n]);return e},BunnyFormData.prototype.getInputType=function(t){var e=null;return e="object"===("undefined"==typeof t?"undefined":_typeof$1(t))?t:this.getInput(t),void 0!==e.type&&null!==e.type&&""!==e.type?e.type:"TEXTAREA"===e.tagName?"textarea":this.isNodeList(e)?"radiolist":void 0},BunnyFormData.prototype.getInput=function(t){return Object.getOwnPropertyDescriptor(this._form.constructor.prototype,"elements").get.call(this._form)[t]},BunnyFormData.prototype.get=function(t){return void 0===this._collection[t]?null:this._collection[t]},BunnyFormData.prototype.set=function(t,e){this._collection[t]=e},BunnyFormData.prototype.setCheckbox=function(t,e,n){if(this.has(t)&&!this.empty(t))if(n)this.isArray(t)?this._collection[t].indexOf(e)===-1&&this._collection[t].push(e):this._collection[t]!==e&&(this._collection[t]=[this._collection[t]],this._collection[t].push(e));else if(this.isArray(t)){var o=this._collection[t].indexOf(e);o!==-1&&(1===this._collection[t].length?this._collection[t]="":this._collection[t].splice(o,1))}else this._collection[t]===e&&(this._collection[t]="");else this._collection[t]=e},BunnyFormData.prototype.has=function(t){return void 0!==this._collection[t]},BunnyFormData.prototype.empty=function(t){return 0===this._collection[t].length},BunnyFormData.prototype.isArray=function(t){return Array.isArray(this._collection[t])},BunnyFormData.prototype.isNodeList=function(t){var e="object"===("undefined"==typeof t?"undefined":_typeof$1(t))?t:this.getInput(t);return e instanceof("undefined"!=typeof RadioNodeList?RadioNodeList:HTMLCollection)},BunnyFormData.prototype.append=function(t,e){if(void 0===this._collection[t])this._collection[t]=e;else if(Array.isArray(this._collection[t]))this._collection[t].push(e);else{var n=this._collection[t];this._collection[t]=[n,e]}},BunnyFormData.prototype.getAll=function(t){return void 0===this._collection[t]?[]:Array.isArray(this._collection[t])?this._collection[t]:[this._collection[t]]},BunnyFormData.prototype.getAllElements=function(){return this._collection},BunnyFormData.prototype.buildFormDataObject=function(){var t=this,e=new FormData,n=function(n){Array.isArray(t._collection[n])?t._collection[n].forEach(function(t){e.append(n,t)}):e.append(n,t._collection[n])};for(var o in this._collection)n(o);return e},BunnyFormData.prototype.remove=function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;void 0!==n&&Array.isArray(this._collection[t])?!function(){var o=[];e._collection[t].forEach(function(t){t!==n&&o.push(t)}),e._collection[t]=o}():delete this._collection[t]};var BunnyFormData=BunnyFormData,Form$1=Form={_collection:{},_mirrorCollection:{},_valueSetFromEvent:!1,init:function(t){var e=document.forms[t];if(void 0===e)throw new Error("Form with ID "+t+" not found in DOM!");if(void 0!==this._collection[t])throw new Error("Form with ID "+t+" already initiated!");this._collection[t]=new BunnyFormData(e),this._attachChangeAndDefaultFileEvent(t),this._attachRadioListChangeEvent(t),this._attachDOMChangeEvent(t)},isInitiated:function(t){return void 0!==this._collection[t]},_attachChangeAndDefaultFileEvent:function(t){var e=this,n=this._collection[t].getInputs();[].forEach.call(n,function(n){if(e.__attachSingleChangeEvent(t,n),e.__observeSingleValueChange(t,n),"file"===n.type&&n.hasAttribute("value")){var o=n.getAttribute("value");""!==o&&e.setFileFromUrl(t,n.name,o)}})},_attachRadioListChangeEvent:function(t){var e=this._collection[t].getRadioLists();for(var n in e){var o=e[n];this.__observeSingleValueChange(t,o)}},__attachSingleChangeEvent:function(t,e){var n=this;e.addEventListener("change",function(o){"file"===e.type&&o.isTrusted?(n._valueSetFromEvent=!0,e.value=e.files[0],n._valueSetFromEvent=!1):n._parseFormControl(t,e,e.value),void 0!==n._mirrorCollection[t]&&n._mirrorCollection[t][e.name]===!0&&n.setMirrors(t,e.name)})},_parseFormControl:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o=this._collection[t].getInputType(e),i=o.toLowerCase();return i=i.charAt(0).toUpperCase()+i.slice(1),i="_parseFormControl"+i,void 0===n&&(i+="Getter"),void 0!==this[i]?this[i](t,e,n):void 0===n?this._parseFormControlDefaultGetter(t,e):void this._parseFormControlDefault(t,e,n)},_parseFormControlDefault:function(t,e,n){this._collection[t].set(e.name,n)},_parseFormControlDefaultGetter:function(t,e){return Object.getOwnPropertyDescriptor(e.constructor.prototype,"value").get.call(e)},_parseFormControlRadiolist:function(t,e,n){for(var o=!1,i=e,r=0;r<i.length;r++){var a=i[r];if(a.value===n){this._collection[t].set(a.name,n),o=!0;break}}if(!o)throw new TypeError('Trying to Form.set() on radio with unexisted value="'+n+'"')},_parseFormControlCheckbox:function(t,e,n){var o=this._collection[t];o.setCheckbox(e.name,n,e.checked)},_parseFormControlFile:function(t,e,n){if(!(""===n||n instanceof Blob||n instanceof File))throw new TypeError("Only empty string, Blob or File object is allowed to be assigned to .value property of file input using Bunny Form");void 0===n.name&&(n.name="blob"),this._collection[t].set(e.name,n)},_parseFormControlFileGetter:function(t,e){return this.get(t,e.name)},__observeSingleValueChange:function(t,e){var n=this;Object.defineProperty(e,"value",{configurable:!0,get:function(){return n._parseFormControl(t,e)},set:function(o){if("file"!==e.type&&Object.getOwnPropertyDescriptor(e.constructor.prototype,"value").set.call(e,o),n._collection[t].isNodeList(e))for(var i=0;i<e.length;i++){var r=e[i];if(r.getAttribute("value")===o&&!n._valueSetFromEvent){var a=new CustomEvent("change");r.dispatchEvent(a);break}}else if(!n._valueSetFromEvent){var c=new CustomEvent("change");e.dispatchEvent(c)}}})},_initNewInput:function(t,e){this._checkInit(t),this._collection[t]._initSingleInput(e),this.__attachSingleChangeEvent(t,e),this.__observeSingleValueChange(t,e,e.name)},_attachDOMChangeEvent:function(t){var e=this,n=document.forms[t],o={childList:!0,subtree:!0},i=new MutationObserver(function(n){n.forEach(function(n){n.addedNodes.length>0?e.__handleAddedNodes(t,n.addedNodes):n.removedNodes.length>0&&e.__handleRemovedNodes(t,n.removedNodes)})});i.observe(n,o)},__handleAddedNodes:function(t,e){for(var n=0;n<e.length;n++){var o=e[n];if("INPUT"===o.tagName)this._initNewInput(t,o);else if(void 0!==o.getElementsByTagName){var i=o.getElementsByTagName("input");if(i.length>0)for(var r=0;r<i.length;r++)this._initNewInput(t,i[r])}}},__handleRemovedNodes:function(t,e){for(var n=0;n<e.length;n++){var o=e[n];if("INPUT"===o.tagName){var i=o;this._collection[t].remove(i.name,i.value)}else if(void 0!==o.getElementsByTagName){var r=o.getElementsByTagName("input");if(r.length>0)for(var a=0;a<r.length;a++){var c=r[a];this._collection[t].remove(c.name,c.value)}}}},initAll:function(){var t=this;[].forEach.call(document.forms,function(e){t.init(e.id)})},_checkInit:function(t){if(void 0===this._collection[t])throw new Error("Form with ID "+t+" is not initiated! Init form with Form.init(form_id) first.")},set:function(t,e,n){this._checkInit(t);var o=this._collection[t].getInput(e);o.value=n},fill:function(t,e){this._checkInit(t);for(var n in e)this._collection[t].has(n)&&this.set(t,n,e[n])},fillOrAppend:function(t,e){this._checkInit(t);for(var n in e)this._collection[t].has(n)?this.set(t,n,e[n]):this.append(t,n,e[n])},observe:function(t,e){var n=this,o=Object.create(e),i=function(e){Object.defineProperty(o,e,{set:function(o){n.set(t,e,o)},get:function(){return n.get(t,e)}})};for(var r in o)i(r);return o},fillAndObserve:function(t,e){this.fill(t,e),this.observe(t,e)},get:function(t,e){return this._checkInit(t),this._collection[t].get(e)},getObservableModel:function(t){return this.observe(t,this.getAll(t))},getAll:function(t){return this._checkInit(t),this._collection[t].getAllElements()},getFormDataObject:function(t){return this._checkInit(t),this._collection[t].buildFormDataObject()},getInput:function(t,e){return this._collection[t].getInput(e)},append:function(t,e,n){this._checkInit(t);var o=this._collection[t];o.append(e,n)},remove:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;this._checkInit(t),this._collection[t].remove(e,n)},mirror:function(t,e){var n=this;this._checkInit(t);var o=this._collection[t].getInput(e);if(!(o instanceof HTMLInputElement))throw new Error("Cannot mirror radio buttons or checkboxes.");void 0===this._mirrorCollection[t]&&(this._mirrorCollection[t]={}),this._mirrorCollection[t][e]=!0,this.setMirrors(t,e),o.addEventListener("change",function(){n.setMirrors(t,e)})},mirrorAll:function(t){var e=this;this._checkInit(t);var n=this._collection[t].getInputs();[].forEach.call(n,function(n){n instanceof HTMLInputElement&&"checkbox"!==n.type&&"radio"!==n.type&&e.mirror(t,n.name)})},getMirrors:function(t,e){return this._checkInit(t),document.querySelectorAll('[data-mirror="'+t+"."+e+'"]')},setMirrors:function(t,e){var n=this;this._checkInit(t);var o=this.getMirrors(t,e),i=this._collection[t].getInput(e);[].forEach.call(o,function(o){if("IMG"===o.tagName){var r=n.get(t,e);""===r?o.src="":0!==r.size&&(o.src=URL.createObjectURL(n.get(t,e)))}else o.textContent=i.value})},setFileFromUrl:function(t,e,n){var o=this,i=new XMLHttpRequest,r=new Promise(function(n,r){i.onload=function(){if(200===i.status){var a=i.response;o.set(t,e,a),n(a)}else r(i)}});return i.open("GET",n,!0),i.responseType="blob",i.send(),r},submit:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{"X-Requested-With":"XMLHttpRequest"};this._checkInit(t);var i=new XMLHttpRequest;null===e&&(e=document.forms[t].hasAttribute("action")?document.forms[t].getAttribute("action"):""),i.open(n,e);var r=new Promise(function(t,e){i.onload=function(){200===i.status?t(i.responseText):e(i)}});for(var a in o)i.setRequestHeader(a,o[a]);return this._collection[t].set("categories",[2,3]),i.send(this.getFormDataObject(t)),r}},BunnyFile={download:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=new XMLHttpRequest,o=new Promise(function(t,e){n.onload=function(){if(200===n.status){var o=n.response;t(o)}else e(n)}});return n.open("GET",t,!0),e&&(n.responseType="blob"),n.send(),o},getSignature:function(t){return new Promise(function(e){var n=new FileReader;n.onloadend=function(){for(var t=new Uint8Array(n.result).subarray(0,4),o="",i=0;i<t.length;i++)o+=t[i].toString(16);e(o)},n.readAsArrayBuffer(t)})},isJpeg:function(t){var e=["ffd8ffe0","ffd8ffe1","ffd8ffe2"];return e.indexOf(t)>-1},isPng:function(t){return"89504e47"===t},base64ToBlob:function(t){for(var e=atob(t.split(",")[1]),n=t.split(",")[0].split(":")[1].split(";")[0],o=new ArrayBuffer(e.length),i=new Uint8Array(o),r=0;r<e.length;r++)i[r]=e.charCodeAt(r);return new Blob([o],{type:n})},blobToBase64:function(t){var e=new FileReader,n=new Promise(function(t,n){e.onloadend=function(){var n=e.result;t(n)},e.onerror=function(t){n(t)}});return e.readAsDataURL(t),n},getBlobLocalURL:function(t){if(!(t instanceof Blob||t instanceof File))throw new TypeError("Argument in BunnyFile.getBlobLocalURL() is not a Blob or File object");return URL.createObjectURL(t)}},BunnyImage={IMG_CONVERT_TYPE:"image/jpeg",IMG_QUALITY:.7,getImage:function(t){return"string"==typeof t?this.getImageByURL(t):this.getImageByBlob(t)},getImageByURL:function(t){return this._toImagePromise(t,!0)},_toImagePromise:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new Image,o=new Promise(function(t,e){n.onload=function(){t(n)},n.onerror=function(t){e(t)}});return e&&(n.crossOrigin="Anonymous"),n.src=t,o},getImageByBlob:function(t){var e=BunnyFile.getBlobLocalURL(t);return this._toImagePromise(e)},getImageByBase64:function(t){var e=t;return this._toImagePromise(e)},getImageByCanvas:function(t){var e=t.toDataURL(this.IMG_CONVERT_TYPE,this.IMG_QUALITY);return this._toImagePromise(e)},imageToCanvas:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!t.complete)throw new Error("Can not create canvas from Image. Image is not loaded yet.");var o=document.createElement("canvas");return null===e&&null===n?(o.width=t.naturalWidth,o.height=t.naturalHeight,o.getContext("2d").drawImage(t,0,0)):(o.width=e,o.height=n,o.getContext("2d").drawImage(t,0,0,e,n)),o},imageToBase64:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.imageToCanvas(t,e,n).toDataURL(this.IMG_CONVERT_TYPE,this.IMG_QUALITY)},imageToBlob:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return BunnyFile.base64ToBlob(this.imageToBase64(t,e,n))},getImageURL:function(t){return t.src},getImageWidth:function(t){if(!t.complete)throw new Error("Can not get Image.width. Image is not loaded yet.");return t.width},getImageHeight:function(t){if(!t.complete)throw new Error("Can not get Image.height. Image is not loaded yet.");return t.height},getImageNewAspectSizes:function(t,e,n){var o=this.getImageWidth(t),i=this.getImageHeight(t);if(0===o||0===i)throw new Error("Image width or height is 0 in BunnyImage.getImageNewAspectSizes().");var r=Math.min(e/o,n/i);return{width:Math.floor(o*r),height:Math.floor(i*r)}},resizeImage:function(t,e,n){var o=this.getImageNewAspectSizes(t,e,n),i=o.width,r=o.height,a=this.imageToCanvas(t,i,r);return this.getImageByCanvas(a)}};Form$1.initAll(),document.forms.form1.elements.name.addEventListener("change",function(){});for(var gender=document.forms.form1.elements.gender,k=0;k<gender.length;k++)gender[k].addEventListener("change",function(){});Form$1.mirrorAll("form1");var link="https://upload.wikimedia.org/wikipedia/commons/thumb/2/2f/Google_2015_logo.svg/400px-Google_2015_logo.svg.png",image=null;BunnyImage.getImageByURL(link).then(function(t){image=t}),document.forms.form1.addEventListener("submit",function(t){t.preventDefault(),Form$1.submit(document.forms[0].id).then(function(t){}).catch(function(t){})}),document.getElementById("set_photo").addEventListener("click",function(t){document.getElementById("form1_submit").setAttribute("disabled","disabled"),Form$1.setFileFromUrl("form1","photo",link).then(function(t){document.getElementById("form1_submit").removeAttribute("disabled")}).catch(function(t){})});var counter=1;document.getElementById("add").addEventListener("click",function(){var t=document.createElement("input");t.type="text",t.name="custom_input",t.value=counter++;var e=document.createElement("a");e.classList.add("btn"),e.classList.add("btn-danger"),e.textContent="Delete";var n=document.createElement("div");n.appendChild(t),n.appendChild(e),e.addEventListener("click",function(){document.forms.form1.removeChild(n)}),document.forms.form1.appendChild(n)});