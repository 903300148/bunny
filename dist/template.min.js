"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},TEMPLATE_EVENT_INIT="init",TEMPLATE_EVENT_FORMAT_DATA="format_data",Template={_loadedTemplates:[],_dataVarName:"v",_dataAttrVarName:"av",define:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],a=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if(void 0!==this._loadedTemplates[e])return console.error('Template with id="'+e+'" already defined!'),!1;var n=document.getElementById(e);if(null===n)return console.error('Template with id="'+e+"\" doesn't exists"),!1;var r=document.createDocumentFragment(),l=null;for(l="TABLE"===n.tagName?n.querySelector("tbody"):n;l.firstChild;)r.appendChild(l.firstChild);return this._loadedTemplates[e]={templateFragment:r,handlers:t,events:a,isTable:"TABLE"===n.tagName},!0},isTable:function(e){return this._loadedTemplates[e].isTable},create:function(e,t){var a={},n=[],r=this._dataVarName,l=this._dataAttrVarName;return void 0===this._loadedTemplates[e]?(console.error('Template with id="'+e+'" is not defined. Use Template.define() first.'),!1):(a.id=e,a.content=this._loadedTemplates[e].templateFragment.cloneNode(!0),a.nodes=[].slice.call(a.content.childNodes,0),a.isTable="TABLE"===this._loadedTemplates[e].tagName,a.varElements=[],[].forEach.call(a.content.querySelectorAll("["+r+"]"),function(e){a.varElements[e.getAttribute(r)]=e}),a.attrVarElements=[],[].forEach.call(a.content.querySelectorAll("["+l+"]"),function(e){n=e.getAttribute(l).split(":"),a.attrVarElements[n[1]]={el:e,attr:n[0]}}),a.handlerElements=[],[].forEach.call(a.content.querySelectorAll("[data-handler]"),function(e){a.handlerElements.push(e)}),void 0!==t&&(a.relatedData=t),a)},parse:function(e,t){var a=Object.create(t);if(void 0===e||null===e)e=[];else if("object"!==("undefined"==typeof e?"undefined":_typeof(e)))return console.error('1st argument of Template.parse() - "data" must be an array or object.'),!1;void 0!==this._loadedTemplates[a.id].events[TEMPLATE_EVENT_FORMAT_DATA]&&(e=this._loadedTemplates[a.id].events[TEMPLATE_EVENT_FORMAT_DATA](e,a.relatedData)),a.escapedData=[];for(var n in e)a.escapedData[n]=this.nl2br(this.escape(e[n])),void 0!==a.varElements[n]&&(a.varElements[n].innerHTML=a.escapedData[n]),void 0!==a.attrVarElements[n]&&a.attrVarElements[n].el.setAttribute(a.attrVarElements[n].attr,e[n]);return a},escape:function(e){return String(e).replace(/&amp;/g,"&").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},nl2br:function(e){return String(e).replace(/(\n)+/g,"<br>")},callHandlers:function(e){for(var t in e.handlerElements){var a=this._loadedTemplates[e.id].handlers[e.handlerElements[t].getAttribute("data-handler")];if(void 0===a)return console.error("Template's \""+e.id+'" handler "'+a+'" does not exists. Pass second argument to Template.define() as object where keys=handler names.'),!1;a(e.handlerElements[t],e.escapedData,e.nodes)}},append:function(e,t){if(null===t||void 0===t)return console.error("Unable to append template to parent element. Passed as 2nd argument to Template.append(). parent_el is: "+t),!1;var a=null;return a=this.isTable(e.id)?t.querySelector("tbody"):t,a.appendChild(e.content),this.callHandlers(e),e.nodes},insert:function(e,t,a){return this.append(this.parse(t,this.create(e)),a)},insertAll:function(e,t,a){for(var n=document.createDocumentFragment(),r=[],l=0;l<t.length;l++){var i=this.create(e);i=this.parse(t[l],i),n.appendChild(i.content),r.push(i)}var d=null;for(d=this.isTable(e)?a.querySelector("tbody"):a,d.appendChild(n),l=0;l<r.length;l++)this.callHandlers(r[l])},insertAdjacencyList:function(e,t,a,n,r,l){(void 0===n||null===n)&&(n="parent_id"),(void 0===l||null===l||"asc"!==l&&"desc"!==l)&&(l="asc");var i={_0:{}};i._0._rendered=!1,i._0.id=0;for(var d in t)i["_"+t[d].id]=t[d],i["_"+t[d].id]._rendered=!1;for(var d in t){var s=i["_"+t[d].id][n];void 0===i["_"+s]._children_ids&&(i["_"+s]._children_ids=[]),i["_"+s]._children_ids.push(t[d].id)}var o=document.createDocumentFragment(),c=[],p=function m(t,a){if(t._rendered===!1)if(t._rendered=!0,0===t.id)for(var n in t._children_ids)m(i["_"+t._children_ids[n]],a);else{var l=u(t),d=Template.create(e,l);if(d=Template.parse(t,d),c.push(d),void 0!==t._children_ids)for(var n in t._children_ids)null===d.content.querySelector("."+r)&&console.error('Element inside template with class "'+r+'" not found. Passed in as 5th argument in Template.insertAdjacencyList() - "branch_container_class"'),m(i["_"+t._children_ids[n]],d.content.querySelector("."+r));a.appendChild(d.content)}},u=function _(e){if(e.parent_id>0){var t={};return t=i["_"+e.parent_id],i["_"+e.parent_id].parent_id>0&&(t.parent=_(i["_"+e.parent_id])),t}};for(p(i._0,o),a.appendChild(o),d=0;d<c.length;d++)this.callHandlers(c[d])}};